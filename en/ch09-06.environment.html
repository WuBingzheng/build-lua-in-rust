<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Environment _ENV - Build a Lua Interpreter in Rust</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="PREFACE.html">Preface</a></li><li class="chapter-item expanded "><a href="ch01-00.hello_world.html"><strong aria-hidden="true">1.</strong> hello, world!</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch01-01.principles.html"><strong aria-hidden="true">1.1.</strong> Basic Compilation Principles</a></li><li class="chapter-item expanded "><a href="ch01-02.byte_codes.html"><strong aria-hidden="true">1.2.</strong> Bytecode</a></li><li class="chapter-item expanded "><a href="ch01-03.value_and_type.html"><strong aria-hidden="true">1.3.</strong> Value and Type</a></li><li class="chapter-item expanded "><a href="ch01-04.lets_do_it.html"><strong aria-hidden="true">1.4.</strong> Let's Do It!</a></li></ol></li><li class="chapter-item expanded "><a href="ch02-00.variables.html"><strong aria-hidden="true">2.</strong> Variables and Assignments</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch02-01.more_types.html"><strong aria-hidden="true">2.1.</strong> More Types</a></li><li class="chapter-item expanded "><a href="ch02-02.local.html"><strong aria-hidden="true">2.2.</strong> Local Variables</a></li><li class="chapter-item expanded "><a href="ch02-03.assignment.html"><strong aria-hidden="true">2.3.</strong> Variable Assignment</a></li></ol></li><li class="chapter-item expanded "><a href="ch03-00.optimize_string.html"><strong aria-hidden="true">3.</strong> String Optimization</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch03-01.string_type.html"><strong aria-hidden="true">3.1.</strong> String Definition</a></li><li class="chapter-item expanded "><a href="ch03-02.from_trait.html"><strong aria-hidden="true">3.2.</strong> Type Conversion</a></li><li class="chapter-item expanded "><a href="ch03-03.read_input.html"><strong aria-hidden="true">3.3.</strong> Input Type</a></li><li class="chapter-item expanded "><a href="ch03-04.unicode_utf8.html"><strong aria-hidden="true">3.4.</strong> Unicode and UTF-8</a></li><li class="chapter-item expanded "><a href="ch03-05.gc_vs_rc.html"><strong aria-hidden="true">3.5.</strong> Garbage Collection and Rc</a></li></ol></li><li class="chapter-item expanded "><a href="ch04-00.table.html"><strong aria-hidden="true">4.</strong> Table and ExpDesc</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch04-01.table_definition.html"><strong aria-hidden="true">4.1.</strong> Table Definition</a></li><li class="chapter-item expanded "><a href="ch04-02.table_constructor.html"><strong aria-hidden="true">4.2.</strong> Table Construction</a></li><li class="chapter-item expanded "><a href="ch04-03.expdesc.html"><strong aria-hidden="true">4.3.</strong> ExpDesc Concept</a></li><li class="chapter-item expanded "><a href="ch04-04.expdesc_rewrite.html"><strong aria-hidden="true">4.4.</strong> ExpDesc Rewrite</a></li><li class="chapter-item expanded "><a href="ch04-05.table_rw_and_bnf.html"><strong aria-hidden="true">4.5.</strong> Table Read/Write and BNF</a></li></ol></li><li class="chapter-item expanded "><a href="ch05-00.arithmetic_ops.html"><strong aria-hidden="true">5.</strong> Numerical Operations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch05-01.unary_ops.html"><strong aria-hidden="true">5.1.</strong> Unary Operations</a></li><li class="chapter-item expanded "><a href="ch05-02.binary_ops.html"><strong aria-hidden="true">5.2.</strong> Binary Operations</a></li><li class="chapter-item expanded "><a href="ch05-03.int_and_float.html"><strong aria-hidden="true">5.3.</strong> Integer and Float</a></li></ol></li><li class="chapter-item expanded "><a href="ch06-00.control_structures.html"><strong aria-hidden="true">6.</strong> Control Structures</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch06-01.if.html"><strong aria-hidden="true">6.1.</strong> if Statement</a></li><li class="chapter-item expanded "><a href="ch06-02.elseif_else.html"><strong aria-hidden="true">6.2.</strong> elseif and else Branches</a></li><li class="chapter-item expanded "><a href="ch06-03.while_break.html"><strong aria-hidden="true">6.3.</strong> while and break Statements</a></li><li class="chapter-item expanded "><a href="ch06-04.repeat_continue.html"><strong aria-hidden="true">6.4.</strong> repeat and continue Statements</a></li><li class="chapter-item expanded "><a href="ch06-05.numerical-for.html"><strong aria-hidden="true">6.5.</strong> numerical-for Statement</a></li><li class="chapter-item expanded "><a href="ch06-06.goto.html"><strong aria-hidden="true">6.6.</strong> goto Statement</a></li></ol></li><li class="chapter-item expanded "><a href="ch07-00.logical_relational.html"><strong aria-hidden="true">7.</strong> Logical and Relational Operations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch07-01.logical_in_condition.html"><strong aria-hidden="true">7.1.</strong> Logical Operations in Conditional Judgment</a></li><li class="chapter-item expanded "><a href="ch07-02.logical_in_evalue.html"><strong aria-hidden="true">7.2.</strong> Logical Operations in Evalue</a></li><li class="chapter-item expanded "><a href="ch07-03.relational_in_condition.html"><strong aria-hidden="true">7.3.</strong> Relational Operations in Conditional Judgment</a></li><li class="chapter-item expanded "><a href="ch07-04.relational_in_evalue.html"><strong aria-hidden="true">7.4.</strong> Relational Operations in Evalue</a></li></ol></li><li class="chapter-item expanded "><a href="ch08-00.function.html"><strong aria-hidden="true">8.</strong> Function</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch08-01.define_and_call.html"><strong aria-hidden="true">8.1.</strong> Definition and Call</a></li><li class="chapter-item expanded "><a href="ch08-02.arguments.html"><strong aria-hidden="true">8.2.</strong> Arguments</a></li><li class="chapter-item expanded "><a href="ch08-03.results.html"><strong aria-hidden="true">8.3.</strong> Return Value</a></li><li class="chapter-item expanded "><a href="ch08-04.rust_functions_and_api.html"><strong aria-hidden="true">8.4.</strong> Rust Functions and API</a></li><li class="chapter-item expanded "><a href="ch08-05.tail_call.html"><strong aria-hidden="true">8.5.</strong> Tail Call</a></li></ol></li><li class="chapter-item expanded "><a href="ch09-00.closure.html"><strong aria-hidden="true">9.</strong> Closure</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch09-01.upvalue.html"><strong aria-hidden="true">9.1.</strong> Upvalue</a></li><li class="chapter-item expanded "><a href="ch09-02.escape_and_closure.html"><strong aria-hidden="true">9.2.</strong> Upvalue Escape and Closure</a></li><li class="chapter-item expanded "><a href="ch09-03.escape_from_block_and_goto.html"><strong aria-hidden="true">9.3.</strong> Escape from Block and goto</a></li><li class="chapter-item expanded "><a href="ch09-04.rust_closure.html"><strong aria-hidden="true">9.4.</strong> Rust Closures</a></li><li class="chapter-item expanded "><a href="ch09-05.generic_for.html"><strong aria-hidden="true">9.5.</strong> generic-for Statement</a></li><li class="chapter-item expanded "><a href="ch09-06.environment.html" class="active"><strong aria-hidden="true">9.6.</strong> Environment _ENV</a></li></ol></li><li class="chapter-item expanded "><a href="TO_BE_CONTINUED.html">To Be Continued</a></li><li class="chapter-item expanded affix "><a href="REFERENCES.html">References</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Build a Lua Interpreter in Rust</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/WuBingzheng/build-lua-in-rust" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="environment-_env"><a class="header" href="#environment-_env">Environment _ENV</a></h1>
<p>Go back to the first &quot;hello, world!&quot; example in Chapter 1. In the output of <code>luac -l</code> displayed at that time, the bytecode for reading the global variable <code>print</code> is as follows:</p>
<pre><code>2 [1] GETTABUP 0 0 0 ; _ENV &quot;print&quot;
</code></pre>
<p>Looking at the complex name of the bytecode and the strange <code>_ENV</code> comment behind it, it is not simple. At that time, this bytecode was not introduced, but the more intuitive bytecode <code>GetGlobal</code> was redefined to read global variables. In this section, letâ€™s supplement the introduction of <code>_ENV</code>.</p>
<h2 id="current-global-variables"><a class="header" href="#current-global-variables">Current Global Variables</a></h2>
<p>Our current handling of global variables is straightforward:</p>
<ul>
<li>
<p>In the syntax analysis stage, variables that are not local variables and upvalues are considered as global variables, and corresponding bytecodes are generated, including <code>GetGlobal</code>, <code>SetGlobal</code> and <code>SetGlobalConst</code>;</p>
</li>
<li>
<p>In the execution phase of the virtual machine, define <code>global: HashMap&lt;String, Value&gt;</code> in the execution state <code>ExeState</code> data structure to represent the global variable table. Subsequent reads and writes to global variables operate on this table.</p>
</li>
</ul>
<p>This approach is intuitive and has no downsides. However, there is another way to bring more powerful features, which is the environment <code>_ENV</code> introduced in Lua version 5.2. &quot;Lua Programming&quot; has a very detailed description of <code>_ENV</code>, including why <code>_ENV</code> should be used instead of global variables and application scenarios. We will not go into details here, but directly introduce its design and implementation.</p>
<h2 id="how-_env-works"><a class="header" href="#how-_env-works">How _ENV Works</a></h2>
<p>The principle of <code>_ENV</code>:</p>
<ul>
<li>
<p>In the parsing phase, convert all global variables into indexes of table &quot;_ENV&quot;, such as <code>g1 = g2</code> to <code>_ENV.g1 = _ENV.g2</code>;</p>
</li>
<li>
<p>So what is <code>_ENV</code> itself? Since all Lua code segments can be considered as a function, <code>_ENV</code> can be considered as a local variable outside the code segment, which is upvalue. For example, for the above code segment <code>g1 = g2</code>, a more complete conversion result is as follows:</p>
</li>
</ul>
<pre><code class="language-lua">local _ENV = XXX -- predefined global variable table
return function (...)
     _ENV.g1 = _ENV.g2
end
</code></pre>
<p>All &quot;global variables&quot; have become indexes of <code>_ENV</code>, and <code>_ENV</code> itself is also an upvalue, so there are no global variables! In addition, the key point is that <code>_ENV</code> itself has nothing special except that it is preset in advance, it is just an ordinary variable. This means that it can be manipulated like ordinary variables, which brings a lot of flexibility, such as a sandbox can be easily implemented. The specific usage scenarios will not be expanded here. If you are interested, you can refer to &quot;Lua Programming&quot;.</p>
<h2 id="implementation-of-_env"><a class="header" href="#implementation-of-_env">Implementation of _ENV</a></h2>
<p>According to the above introduction, use <code>_ENV</code> to transform global variables.</p>
<p>First, in the syntax analysis stage, the global variable is transformed into an index to <code>_ENV</code>. The relevant code is as follows:</p>
<pre><code class="language-rust  ignore">fn simple_name(&amp;mut self, name: String) -&gt; ExpDesc {
     // Omit the matching of local variables and upvalue, and return directly if they match.

     // If there is no match,
     // - Previously considered to be a global variable, return ExpDesc::Global(name)
     // - Now transformed into _ENV.name, the code is as follows:
     let env = self.simple_name(&quot;_ENV&quot;.into()); // call recursively, look for _ENV
     let ienv = self. discharge_any(env);
     ExpDesc::IndexField(ienv, self. add_const(name))
}</code></pre>
<p>In the above code, first try to match the variable <code>name</code> from local variables and upvalue. This part was introduced in detail in <a href="./ch09-02.escape_and_closure.html">upvalue</a> and is omitted here. Here we only look at the case where the matching fails. In this case, <code>name</code> was previously considered to be a global variable, and <code>ExpDesc::Global(name)</code> was returned. Now to transform it into <code>_ENV.name</code>, it is necessary to locate <code>_ENV</code> first. Since <code>_ENV</code> is also an ordinary variable, the <code>simple_name()</code> function is called recursively with <code>_ENV</code> as an argument. In order to ensure that this call does not recurse infinitely, it is necessary to pre-set <code>_ENV</code> in the preparation phase of syntax analysis. So in this recursive call, <code>_ENV</code> will definitely be matched as a local variable or upvalue, and will not be called recursively again.</p>
<p>So how to pre-set <code>_ENV</code>? In the above introduction, <code>_ENV</code> is the upvalue as the whole code block. But for the sake of convenience, we can use <code>_ENV</code> as a parameter in the <code>load()</code> function to achieve the same effect:</p>
<pre><code class="language-rust  ignore">pub fn load(input: impl Read) -&gt; FuncProto {
     let mut ctx = ParseContext { /* omitted */ };

     // _ENV as the first and only parameter
     chunk(&amp;mut ctx, false, vec![&quot;_ENV&quot;.into()], Token::Eos)
}</code></pre>
<p>In this way, when parsing the outermost code of the code block, when the <code>simple_name()</code> function is called, a local variable of <code>_ENV</code> will be matched; and an upvalue of <code>_ENV</code> will be matched for the code inside the function.</p>
<p>This is just a promise that there must be a <code>_ENV</code> variable. And the fulfillment of this promise needs to be performed in the virtual machine execution stage. When creating an execution state <code>ExeState</code>, immediately after the function entry, <code>_ENV</code> must be pushed onto the stack as the first parameter. In fact, the previous initialization of the <code>global</code> member in <code>ExeState</code> is transferred to the stack. code show as below:</p>
<pre><code class="language-rust  ignore">impl ExeState {
     pub fn new() -&gt; Self {
         // global variable table
         let mut env = Table::new(0, 0);
         env.map.insert(&quot;print&quot;.into(), Value::RustFunction(lib_print));
         env.map.insert(&quot;type&quot;.into(), Value::RustFunction(lib_type));
         env.map.insert(&quot;ipairs&quot;.into(), Value::RustFunction(ipairs));
         env.map.insert(&quot;new_counter&quot;.into(), Value::RustFunction(test_new_counter));

         ExeState {
             // Push 2 values on the stack: the virtual function entry, and the global variable table _ENV
             stack: vec![Value::Nil, Value::Table(Rc::new(RefCell::new(env)))],
             base: 1, // for entry function
         }
     }</code></pre>
<p>In this way, the transformation of <code>_ENV</code> is basically completed. This transformation is very simple, but the function it brings is very powerful, so <code>_ENV</code> is a very beautiful design.</p>
<p>In addition, since there is no concept of global variables, the previous codes related to global variables, such as <code>ExpDesc::Global</code> and the generation and execution of 3 bytecodes related to global variables, can be deleted. Note that no new ExpDesc or bytecode is introduced to implement <code>_ENV</code>. But just not yet.</p>
<h2 id="optimization"><a class="header" href="#optimization">Optimization</a></h2>
<p>Although the above transformation is fully functional, there is a performance problem. Since <code>_ENV</code> is upvalue in most cases, for global variables, two bytecodes will be generated in the above <code>simple_name()</code> function:</p>
<pre><code>Getupvalue ($tmp_table, _ENV) # first load _ENV onto the stack
GetField ($dst, $tmp_table, $key) # before indexing
</code></pre>
<p>In the original scheme that does not use <code>_ENV</code>, only one bytecode <code>GetGlobal</code> is needed. This new solution obviously reduces performance. To make up for the performance loss here, it is only necessary to provide bytecodes that can directly index the upvalue table. To do this, add 3 bytecodes:</p>
<pre><code class="language-rust  ignore">pub enum ByteCode {
     // Deleted 3 old bytecodes that directly manipulate the global variable table
     // GetGlobal(u8, u8),
     // SetGlobal(u8, u8),
     // SetGlobalConst(u8, u8),

     // Add 3 corresponding bytecodes for operating the upvalue table
     GetUpField(u8, u8, u8),
     SetUpField(u8, u8, u8),
     SetUpFieldConst(u8, u8, u8),</code></pre>
<p>Correspondingly, the expression of the upvalue table index should also be increased:</p>
<pre><code class="language-rust  ignore">enum ExpDesc {
     // deleted global variable
     // Global(usize),

     // Added index to upvalue table
     IndexUpField(usize, usize),</code></pre>
<p>The index to the upvalue table here only supports string constants, which is also the scenario for global variables. Although this <code>IndexUpField</code> is added for global variable optimization, it can also be applied to ordinary upvalue table indexes. Therefore, in the function of parsing table indexes, <code>IndexUpField</code> optimization can also be added. The specific code is omitted here.</p>
<p>After defining <code>IndexUpField</code>, the original variable parsing function can be modified:</p>
<pre><code class="language-rust  ignore">fn simple_name(&amp;mut self, name: String) -&gt; ExpDesc {
     // Omit the matching of local variables and upvalue, and return directly if they match.

     // If there is no match,
     // - Previously considered to be a global variable, return ExpDesc::Global(name)
     // - Now transformed into _ENV.name, the code is as follows:
     let iname = self. add_const(name);
     match self. simple_name(&quot;_ENV&quot;.into()) {
         ExpDesc::Local(i) =&gt; ExpDesc::IndexField(i, iname),
         ExpDesc::upvalue(i) =&gt; ExpDesc::IndexUpField(i, iname), // new IndexUpField
         _ =&gt; panic!(&quot;no here&quot;), // because &quot;_ENV&quot; must exist!
     }
}</code></pre>
<p>As before, after a variable fails to match both the local variable and the upvalue, it still uses <code>_ENV</code> as a parameter to recursively call the <code>simple_name()</code> function. But here we know that the result returned by <code>_ENV</code> must be a local variable or an upvalue. In these two cases, <code>ExpDesc::IndexField</code> and <code>ExpDesc::IndexUpField</code> are generated respectively. Then generate the 3 new bytecodes above when reading and writing <code>ExpDesc::IndexUpField</code>.</p>
<p>In this way, it is equivalent to replacing <code>ExpDesc::Global</code> with <code>ExpDesc::IndexUpField</code>. The processing of <code>ExpDesc::Global</code> was deleted before, and now it is added back from <code>ExpDesc::IndexUpField</code>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="ch09-05.generic_for.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="TO_BE_CONTINUED.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="ch09-05.generic_for.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="TO_BE_CONTINUED.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
